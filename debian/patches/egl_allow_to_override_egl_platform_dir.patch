From a597342707f95c01de653021e45d05c8c3685a05 Mon Sep 17 00:00:00 2001
From: Bhushan Shah <bhush94@gmail.com>
Date: Thu, 25 Oct 2018 13:35:36 +0530
Subject: [PATCH] egl: allow to override egl platform dir

This is useful in bundled environment.
---
 hybris/egl/ws.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/hybris/egl/ws.c b/hybris/egl/ws.c
index b10c7041..cd5270ba 100644
--- a/hybris/egl/ws.c
+++ b/hybris/egl/ws.c
@@ -40,7 +40,12 @@ static void _init_ws()
 		if (egl_platform == NULL)
 			egl_platform = DEFAULT_EGL_PLATFORM;
 
-		snprintf(ws_name, 2048, PKGLIBDIR "eglplatform_%s.so", egl_platform);
+		const char *eglplatform_dir = PKGLIBDIR;
+		const char *user_eglplatform_dir = getenv("HYBRIS_EGLPLATFORM_DIR");
+		if (user_eglplatform_dir)
+			eglplatform_dir = user_eglplatform_dir;
+
+		snprintf(ws_name, 2048, "%s/eglplatform_%s.so", eglplatform_dir, egl_platform);
 
 		void *wsmod = (void *) dlopen(ws_name, RTLD_LAZY);
 		if (wsmod==NULL)
